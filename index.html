<!DOCTYPE html>
<html lang="ro">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Marc.ro - Vinde, Cumpără, Găsește!</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body>
    <!-- Header -->
    <header class="header">
        <div class="container">
            <nav class="navbar">
                <div class="logo">
                    <i class="fas fa-circle-notch"></i>
                    <span>Marc.ro</span>
                </div>
                <ul class="nav-menu">
                    <li><a href="index.html" class="active"><i class="fas fa-home"></i> Acasă</a></li>
                    <li><a href="publica-anunt.html"><i class="fas fa-plus-circle"></i> Publică Anunț</a></li>
                    <li><a href="cautare.html"><i class="fas fa-search"></i> Caută</a></li>
                    <li><a href="favorite.html"><i class="fas fa-heart"></i> Favorite</a></li>
                    <li><a href="chat.html" id="chat-link"><i class="fas fa-comments"></i> Chat</a></li>
                    <li><a href="notificari.html" id="notificari-link" class="notificari-link">
                        <i class="fas fa-bell"></i> Notificări
                        <span class="notificari-badge" id="notificari-badge" style="display: none;">0</span>
                    </a></li>
                    <li class="dropdown">
                        <a href="#" class="user-menu"><i class="fas fa-user-circle"></i></a>
                        <div class="dropdown-content">
                            <a href="contul-meu.html">Contul Meu</a>
                            <a href="anunturi-mele.html">Anunțurile Mele</a>
                            <a href="mesaje.html">Mesaje</a>
                            <a href="plati.html">Plăți</a>
                            <a href="ratinguri.html">Ratinguri</a>
                            <a href="setari.html">Setări</a>
                            <a href="#" id="admin-link" style="display: none;" onclick="window.location.href='admin.html'">Admin Panel</a>
                            <a href="#" onclick="logout()">Deconectare</a>
                        </div>
                    </li>
                </ul>
                <div class="mobile-menu-btn">
                    <i class="fas fa-bars"></i>
                </div>
            </nav>
        </div>
    </header>

    <!-- Hero Section -->
    <section class="hero">
        <div class="container">
            <div class="hero-content">
                <h1 class="hero-title">Marc.ro</h1>
                <p class="hero-subtitle">Vinde, Cumpără, Găsește!</p>
                <button class="btn btn-primary btn-large" onclick="window.location.href='publica-anunt.html'">
                    Publică anunț
                </button>
            </div>
        </div>
    </section>

    <!-- Action Buttons -->
    <section class="action-buttons">
        <div class="container">
            <div class="actions-grid">
                <button class="btn btn-success" onclick="window.location.href='cautare.html?type=produse'">
                    Caută produse
                </button>
                <button class="btn btn-success" onclick="window.location.href='cautare.html?type=servicii'">
                    Găsește servicii
                </button>
                <button class="btn btn-success" onclick="window.location.href='promovare.html'">
                    Promovează anunțul
                </button>
            </div>
        </div>
    </section>

    <!-- Statistics -->
    <section class="statistics">
        <div class="container">
            <div class="stats-grid">
                <div class="stat-item">
                    <div class="stat-number" id="stat-anunturi">0</div>
                    <div class="stat-label">Anunțuri</div>
                </div>
                <div class="stat-item">
                    <div class="stat-number" id="stat-utilizatori">0</div>
                    <div class="stat-label">Utilizatori</div>
                </div>
                <div class="stat-item">
                    <div class="stat-number" id="stat-noi-azi">0</div>
                    <div class="stat-label">Anunțuri noi azi</div>
                </div>
                <div class="stat-item">
                    <div class="stat-number" id="stat-noi-saptamana">0</div>
                    <div class="stat-label">Anunțuri noi săptămâna aceasta</div>
                </div>
            </div>
        </div>
    </section>

    <!-- Categories -->
    <section class="categories">
        <div class="container">
            <h2 class="section-title">Categorii principale</h2>
            <div class="categories-grid">
                <a href="anunturi.html?categorie=imobiliare" class="category-card">
                    <div class="category-icon">
                        <i class="fas fa-home"></i>
                    </div>
                    <div class="category-name">Imobiliare</div>
                </a>
                <a href="anunturi.html?categorie=auto-moto" class="category-card">
                    <div class="category-icon">
                        <i class="fas fa-car"></i>
                    </div>
                    <div class="category-name">Auto & Moto</div>
                </a>
                <a href="anunturi.html?categorie=mobilier-casa" class="category-card">
                    <div class="category-icon">
                        <i class="fas fa-couch"></i>
                    </div>
                    <div class="category-name">Mobilier & Casă</div>
                </a>
                <a href="anunturi.html?categorie=joburi" class="category-card">
                    <div class="category-icon">
                        <i class="fas fa-briefcase"></i>
                    </div>
                    <div class="category-name">Joburi</div>
                </a>
                <a href="anunturi.html?categorie=electronice" class="category-card">
                    <div class="category-icon">
                        <i class="fas fa-mobile-alt"></i>
                    </div>
                    <div class="category-name">Electronice</div>
                </a>
                <a href="anunturi.html?categorie=animale" class="category-card">
                    <div class="category-icon">
                        <i class="fas fa-paw"></i>
                    </div>
                    <div class="category-name">Animale</div>
                </a>
                <a href="anunturi.html?categorie=animale-companie" class="category-card">
                    <div class="category-icon">
                        <i class="fas fa-dog"></i>
                    </div>
                    <div class="category-name">Animale de companie</div>
                </a>
                <a href="anunturi.html?categorie=fashion" class="category-card">
                    <div class="category-icon">
                        <i class="fas fa-tshirt"></i>
                    </div>
                    <div class="category-name">Modă</div>
                </a>
            </div>
        </div>
    </section>

    <!-- Recent Ads -->
    <section class="recent-ads">
        <div class="container">
            <h2 class="section-title">Anunțuri recente</h2>
            <div class="ads-grid" id="recent-ads-container">
                <!-- Anunțurile vor fi încărcate dinamic aici -->
                <div style="text-align: center; padding: 40px; color: var(--text-light);">
                    <i class="fas fa-spinner fa-spin" style="font-size: 32px; margin-bottom: 10px;"></i>
                    <p>Se încarcă anunțurile...</p>
                </div>
            </div>

            <div class="view-more">
                <button class="btn btn-outline" onclick="window.location.href='anunturi.html'">
                    Vezi toate anunțurile
                </button>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer class="footer">
        <div class="container">
            <div class="footer-content">
                <div class="footer-links">
                    <a href="contact.html">Contact</a>
                    <a href="termeni.html">Termeni</a>
                    <a href="ajutor.html">Ajutor</a>
                    <a href="despre.html">Despre noi</a>
                </div>
                <div class="footer-copyright">
                    <p>&copy; 2025 Marc.ro. Toate drepturile rezervate.</p>
                </div>
                <div class="footer-social">
                    <a href="#"><i class="fab fa-facebook"></i></a>
                    <a href="#"><i class="fab fa-instagram"></i></a>
                    <a href="#"><i class="fab fa-twitter"></i></a>
                    <a href="#"><i class="fab fa-linkedin"></i></a>
                </div>
            </div>
        </div>
    </footer>

    <script src="js/config.js"></script>
    <script src="script.js"></script>
    <script src="js/header-auth.js"></script>
    <script>
        // Dropdown-ul este inițializat în script.js
        // Header-ul este actualizat în js/header-auth.js
        // Nu mai este nevoie de cod suplimentar aici
    </script>
    <script>
        // Formatează numărul cu separator de mii
        function formatNumber(num) {
            return new Intl.NumberFormat('ro-RO').format(num);
        }

        // Încarcă statisticile
        async function loadStats() {
            try {
                const response = await fetch(API_CONFIG.BASE_URL + 'stats.php');
                const result = await response.json();
                
                if (response.ok) {
                    document.getElementById('stat-anunturi').textContent = formatNumber(result.anunturi || 0);
                    document.getElementById('stat-utilizatori').textContent = formatNumber(result.utilizatori || 0);
                    document.getElementById('stat-noi-azi').textContent = formatNumber(result.anunturi_noi_azi || 0);
                    document.getElementById('stat-noi-saptamana').textContent = formatNumber(result.anunturi_noi_saptamana || 0);
                }
            } catch (error) {
                console.error('Eroare la încărcarea statisticilor:', error);
            }
        }

        // Încarcă anunțurile recente
        async function loadRecentAds() {
            try {
                const result = await Anunturi.getAll({ limit: 6 });
                const ads = result.anunturi || [];
                
                const container = document.getElementById('recent-ads-container');
                
                if (ads.length === 0) {
                    container.innerHTML = `
                        <div style="text-align: center; padding: 40px; color: var(--text-light);">
                            <i class="fas fa-inbox" style="font-size: 48px; margin-bottom: 15px; opacity: 0.5;"></i>
                            <p style="font-size: 18px;">Nu sunt anunțuri disponibile momentan.</p>
                        </div>
                    `;
                    return;
                }
                
                container.innerHTML = ads.map(ad => {
                    const imgUrl = ad.imagini && ad.imagini.length > 0 
                        ? ad.imagini[0] 
                        : 'https://via.placeholder.com/300x200?text=Anunț';
                    
                    return `
                        <div class="ad-card" onclick="window.location.href='anunt-detalii.html?id=${ad.id}'" style="cursor: pointer;">
                            <div class="ad-image">
                                <img src="${imgUrl}" alt="${ad.titlu}">
                                <button class="favorite-btn" onclick="event.stopPropagation(); toggleFavorite(this)"><i class="far fa-heart"></i></button>
                            </div>
                            <div class="ad-content">
                                <div class="ad-price">${Utils.formatPrice(parseFloat(ad.pret || 0), ad.moneda || 'RON')}</div>
                                <h3 class="ad-title">${ad.titlu}</h3>
                                <div class="ad-location"><i class="fas fa-map-marker-alt"></i> ${ad.oras || 'N/A'}${ad.judet ? ', ' + ad.judet : ''}</div>
                                <div class="ad-date">${Utils.formatRelativeDate(ad.data_creare)}</div>
                            </div>
                        </div>
                    `;
                }).join('');
            } catch (error) {
                console.error('Eroare la încărcarea anunțurilor:', error);
                document.getElementById('recent-ads-container').innerHTML = `
                    <div style="text-align: center; padding: 40px; color: var(--danger-color);">
                        <i class="fas fa-exclamation-triangle" style="font-size: 48px; margin-bottom: 15px;"></i>
                        <p style="font-size: 18px;">Eroare la încărcarea anunțurilor.</p>
                    </div>
                `;
            }
        }

        // Încarcă numărul de notificări
        async function loadNotificationsCount() {
            try {
                const authCheck = await Auth.check();
                if (authCheck && authCheck.autentificat) {
                    const result = await API.get('notificari.php');
                    const badge = document.getElementById('notificari-badge');
                    if (badge && result.necitite > 0) {
                        badge.textContent = result.necitite;
                        badge.style.display = 'inline-block';
                    } else if (badge) {
                        badge.style.display = 'none';
                    }
                } else {
                    // Ascunde badge-ul dacă nu e autentificat
                    const badge = document.getElementById('notificari-badge');
                    if (badge) badge.style.display = 'none';
                }
            } catch (error) {
                // Ignoră erorile pentru utilizatorii neautentificați
                const badge = document.getElementById('notificari-badge');
                if (badge) badge.style.display = 'none';
            }
        }

        // Inițializare când se încarcă pagina
        document.addEventListener('DOMContentLoaded', function() {
            // Header-ul este actualizat automat de js/header-auth.js
            // Nu mai apelăm updateHeaderAuth() aici pentru a evita duplicate
            
            loadStats();
            loadRecentAds();
            loadNotificationsCount();
            
            // Reîmprospătează statisticile la fiecare 30 de secunde
            setInterval(loadStats, 30000);
            // Reîmprospătează notificările la fiecare 60 de secunde
            setInterval(loadNotificationsCount, 60000);
        });
    </script>
</body>
</html>

